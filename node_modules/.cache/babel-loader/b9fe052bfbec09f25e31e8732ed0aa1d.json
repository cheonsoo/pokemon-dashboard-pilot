{"ast":null,"code":"import _slicedToArray from \"/Users/mansoo/Workspace/nodejs/pokemon-dashboard-pilot/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\n\nvar _jsxFileName = \"/Users/mansoo/Workspace/nodejs/pokemon-dashboard-pilot/src/components/organisms/pokemonList/index.jsx\",\n    _this = this,\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useInfiniteQuery } from \"react-query\";\nimport { css } from \"@emotion/react\";\nimport PokemonDetail from \"../pokemonDetail\";\nimport { getPokemonList } from \"../../../api/\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar TIMER;\n\nvar PokemonList = function PokemonList() {\n  _s();\n\n  var _useState = useState(0),\n      _useState2 = _slicedToArray(_useState, 2),\n      page = _useState2[0],\n      setPage = _useState2[1];\n\n  var pageRef = useRef(page);\n\n  var _useState3 = useState(\"\"),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedName = _useState4[0],\n      setSelectedName = _useState4[1];\n\n  var _useState5 = useState(false),\n      _useState6 = _slicedToArray(_useState5, 2),\n      openDetailModal = _useState6[0],\n      setOpenDetailModal = _useState6[1];\n\n  var _useInfiniteQuery = useInfiniteQuery(\"get-pokemon-list\", getPokemonList, {\n    refetchOnWindowFocus: false,\n    suspense: true,\n    getNextPageParam: function getNextPageParam(lastPage) {\n      return lastPage.nextCursor;\n    }\n  }),\n      data = _useInfiniteQuery.data,\n      fetchNextPage = _useInfiniteQuery.fetchNextPage;\n\n  var setPageRef = function setPageRef(_page) {\n    pageRef.current = _page;\n    setPage(_page);\n  };\n\n  var scrollEvent = function scrollEvent(_page) {\n    if (!TIMER) {\n      TIMER = setTimeout(function () {\n        TIMER = null;\n        var windowHeight = window.document.body.getBoundingClientRect().height - window.screen.availHeight + 111;\n        var poz = window.scrollY;\n        console.log(\"windowHeight: \".concat(windowHeight, \", poz: \").concat(poz));\n\n        if (poz === 0) {\n          console.log(\"hit top\");\n        } else if (poz > windowHeight) {\n          console.log(\"hit bottom\");\n          setPageRef(pageRef.current + 1);\n          fetchNextPage({\n            pageParam: pageRef.current + 1\n          });\n        }\n      }, 500);\n    }\n  };\n\n  useEffect(function () {\n    document.addEventListener(\"scroll\", function () {\n      return scrollEvent(page);\n    });\n  }, []);\n\n  var handleClick = function handleClick(name) {\n    setSelectedName(name);\n    setOpenDetailModal(!openDetailModal);\n  };\n\n  var handleClose = useCallback(function () {\n    setOpenDetailModal(false);\n  }, []);\n  var listContainer = css({\n    padding: \"200px\",\n    backgroundColor: \"red\"\n  });\n\n  var listItems = function listItems(list) {\n    return list.map(function (item, idx) {\n      return /*#__PURE__*/_jsxDEV(\"li\", {\n        onClick: function onClick() {\n          return handleClick(item.name);\n        },\n        style: {\n          width: \"200px\",\n          height: \"50px\",\n          backgroundColor: \"#eeeeee\",\n          marginBottom: \"10px\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            width: \"100%\",\n            height: \"100%\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            fontWeight: \"900\",\n            cursor: \"pointer\"\n          },\n          children: item.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 9\n        }, _this)\n      }, idx, false, {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 7\n      }, _this);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      css: listContainer,\n      children: /*#__PURE__*/_jsxDEV(\"ul\", {\n        style: {\n          listStyle: \"none\",\n          width: \"500px\"\n        },\n        children: data === null || data === void 0 ? void 0 : data.pages.map(function (page) {\n          return listItems(page);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 7\n    }, _this), openDetailModal && /*#__PURE__*/_jsxDEV(PokemonDetail, {\n      open: openDetailModal,\n      name: selectedName,\n      handleClose: handleClose\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 9\n    }, _this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 100,\n    columnNumber: 5\n  }, _this);\n};\n\n_s(PokemonList, \"Iph6+772w8D+MHK+h1QtaNyJU9M=\", false, function () {\n  return [useInfiniteQuery];\n});\n\n_c = PokemonList;\nexport default PokemonList;\n\nvar _c;\n\n$RefreshReg$(_c, \"PokemonList\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","useRef","useInfiniteQuery","css","PokemonDetail","getPokemonList","TIMER","PokemonList","page","setPage","pageRef","selectedName","setSelectedName","openDetailModal","setOpenDetailModal","refetchOnWindowFocus","suspense","getNextPageParam","lastPage","nextCursor","data","fetchNextPage","setPageRef","_page","current","scrollEvent","setTimeout","windowHeight","window","document","body","getBoundingClientRect","height","screen","availHeight","poz","scrollY","console","log","pageParam","addEventListener","handleClick","name","handleClose","listContainer","padding","backgroundColor","listItems","list","map","item","idx","width","marginBottom","display","alignItems","justifyContent","fontWeight","cursor","listStyle","pages"],"sources":["/Users/mansoo/Workspace/nodejs/pokemon-dashboard-pilot/src/components/organisms/pokemonList/index.jsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useRef } from \"react\";\nimport { useInfiniteQuery } from \"react-query\";\nimport { css } from \"@emotion/react\";\nimport PokemonDetail from \"../pokemonDetail\";\nimport { getPokemonList } from \"../../../api/\";\n\nlet TIMER;\n\nconst PokemonList = () => {\n  const [page, setPage] = useState(0);\n  const pageRef = useRef(page);\n  const [selectedName, setSelectedName] = useState(\"\");\n  const [openDetailModal, setOpenDetailModal] = useState(false);\n\n  const { data, fetchNextPage } = useInfiniteQuery(\n    \"get-pokemon-list\",\n    getPokemonList,\n    {\n      refetchOnWindowFocus: false,\n      suspense: true,\n      getNextPageParam: (lastPage) => lastPage.nextCursor\n    }\n  );\n\n  const setPageRef = (_page) => {\n    pageRef.current = _page;\n    setPage(_page);\n  };\n\n  const scrollEvent = (_page) => {\n    if (!TIMER) {\n      TIMER = setTimeout(() => {\n        TIMER = null;\n        const windowHeight =\n          window.document.body.getBoundingClientRect().height -\n          window.screen.availHeight +\n          111;\n        const poz = window.scrollY;\n        console.log(`windowHeight: ${windowHeight}, poz: ${poz}`);\n\n        if (poz === 0) {\n          console.log(\"hit top\");\n        } else if (poz > windowHeight) {\n          console.log(\"hit bottom\");\n          setPageRef(pageRef.current + 1);\n          fetchNextPage({ pageParam: pageRef.current + 1 });\n        }\n      }, 500);\n    }\n  };\n\n  useEffect(() => {\n    document.addEventListener(\"scroll\", () => scrollEvent(page));\n  }, []);\n\n  const handleClick = (name) => {\n    setSelectedName(name);\n    setOpenDetailModal(!openDetailModal);\n  };\n\n  const handleClose = useCallback(() => {\n    setOpenDetailModal(false);\n  }, []);\n\n  const listContainer = css({\n    padding: \"200px\",\n    backgroundColor: \"red\"\n  });\n\n  const listItems = (list) => {\n    return list.map((item, idx) => (\n      <li\n        key={idx}\n        onClick={() => handleClick(item.name)}\n        style={{\n          width: \"200px\",\n          height: \"50px\",\n          backgroundColor: \"#eeeeee\",\n          marginBottom: \"10px\"\n        }}\n      >\n        <div\n          style={{\n            width: \"100%\",\n            height: \"100%\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\",\n            fontWeight: \"900\",\n            cursor: \"pointer\"\n          }}\n        >\n          {item.name}\n        </div>\n      </li>\n    ));\n  };\n\n  return (\n    <div>\n      <div css={listContainer}>\n        <ul style={{ listStyle: \"none\", width: \"500px\" }}>\n          {data?.pages.map((page) => listItems(page))}\n        </ul>\n      </div>\n\n      {openDetailModal && (\n        <PokemonDetail\n          open={openDetailModal}\n          name={selectedName}\n          handleClose={handleClose}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default PokemonList;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}