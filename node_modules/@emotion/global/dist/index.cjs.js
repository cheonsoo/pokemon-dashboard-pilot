'use strict';

var React = require('react');
var core = require('@emotion/core');
var sheet = require('@emotion/sheet');
var utils = require('@emotion/utils');
var serialize = require('@emotion/serialize');

function _inheritsLoose(subClass, superClass) {
  subClass.prototype = Object.create(superClass.prototype);
  subClass.prototype.constructor = subClass;
  subClass.__proto__ = superClass;
}

function _componentWillUnmount() {
  this.sheet.flush();
}

function _render() {
  return core.consume(this.renderChild);
}

var Global =
/*#__PURE__*/
function (_React$Component) {
  _inheritsLoose(Global, _React$Component);

  function Global(props) {
    var _this;

    _this = _React$Component.call(this, props) || this;

    function _ref(rule) {
      _this.sheet.insert(rule);
    }

    _this.renderChild = function (context) {
      var serialized = serialize.serializeStyles(context.registered, [_this.props.css]);

      if (_this.oldName !== serialized.name) {
        if (utils.isBrowser) {
          _this.sheet = new sheet.StyleSheet({
            // $FlowFixMe
            key: context.sheet.key + "-global",
            // $FlowFixMe
            nonce: context.sheet.nonce,
            // $FlowFixMe
            container: context.sheet.container
          });
        }

        _this.oldName = serialized.name;
        var rules = context.stylis("", serialized.styles);

        if (utils.shouldSerializeToReactTree) {
          _this.serialized = rules.join('');
        }

        if (utils.isBrowser) {
          _this.sheet.flush();

          rules.forEach(_ref);
        }
      }

      if (utils.shouldSerializeToReactTree) {
        return React.createElement("style", {
          "data-emotion-ssr": serialized.name,
          dangerouslySetInnerHTML: {
            __html: _this.serialized
          }
        });
      }

      return null;
    };

    return _this;
  }

  var _proto = Global.prototype;
  _proto.componentWillUnmount = _componentWillUnmount;
  _proto.render = _render;
  return Global;
}(React.Component);

Global.__emotion_component = true;

module.exports = Global;
//# sourceMappingURL=index.cjs.js.map
